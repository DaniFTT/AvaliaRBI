@using AvaliaRBI.Shared.Extensions;
@using static AvaliaRBI._2___Application.Shared.Notification;

﻿<MudDialog>
    <TitleContent>
        <MudGrid Style="padding: 1rem 0 0rem 0.7rem">
                <MudText Typo="Typo.h6">
                    Detalhes da Importação
                </MudText>
        </MudGrid>
    </TitleContent>
    <DialogContent>
        <MudGrid >
            <MudItem xs="12">
                <MudText Style="font-size: 1rem;">@ImportModel?.Title</MudText>
                <MudText Typo="Typo.caption" Style="padding-top: 0.3rem;font-size: 0.7rem;">Finalizado em: @ImportModel?.FinishDate.ToString("dd/MM/yyy HH:mm:ss")</MudText>
            </MudItem>
            <MudItem xs="6">
                <MudCard Style="height: 5rem;" Elevation="3">
                    <MudCardContent Style="padding: 12px;">
                        <MudText Typo="Typo.body2" Style="font-size: 0.8rem;">Nome do Arquivo</MudText>
                        <MudText Style="padding-top: 0.6rem;font-size: 0.9rem;">@ImportModel?.FileName</MudText>
                    </MudCardContent>
                </MudCard>
            </MudItem>
            <MudItem xs="2">
                <MudCard Style="height: 5rem;" Elevation="3">
                    <MudCardContent Style="padding: 12px;">
                        <MudText Typo="Typo.body2" Style="font-size: 0.8rem;">Processados</MudText>
                        <MudText Style="padding-top: 0.6rem;font-size: 0.9rem;">@ImportModel?.ProcessedCount</MudText>
                    </MudCardContent>
                </MudCard>
            </MudItem>
            <MudItem xs="2">
                <MudCard Style="height: 5rem;" Elevation="3">
                    <MudCardContent Style="padding: 12px;">
                        <MudText Typo="Typo.body2" Style="font-size: 0.8rem;">Inseridos</MudText>
                        <MudText Style="padding-top: 0.6rem;font-size: 0.9rem;">@ImportModel?.InsertedCount</MudText>
                    </MudCardContent>
                </MudCard>
            </MudItem>
            <MudItem xs="2">
                <MudCard Style="height: 5rem;" Elevation="3">
                    <MudCardContent Style="padding: 12px;">
                        <MudText Typo="Typo.body2" Style="font-size: 0.8rem;">Atualizados</MudText>
                        <MudText Style="padding-top: 0.6rem;font-size: 0.9rem;">@ImportModel?.UpdatedCount</MudText>
                        </MudCardContent>
                    </MudCard>
                </MudItem>
        </MudGrid>

        <br />
        @if (ImportModel != null && ImportModel.Notas.Any())
        {
            <MudTable Elevation="3" Items="@ImportModel.Notas" FixedHeader="true" Height="280px" Dense="true" Hover="true" Striped="true">
                <ColGroup>
                    <col style="width: 5%;" />
                    <col style="width: 85%;" />
                    <col style="width: 10%;" />
                    <col />
                </ColGroup>
                <HeaderContent>
                    <MudTh>Linha</MudTh>
                    <MudTh>Mensagem</MudTh>
                    <MudTh>Tipo</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd DataLabel="Linha">@context.Row.ToString()</MudTd>
                    <MudTd DataLabel="Mensagem">@context.Message</MudTd>
                    <MudTd DataLabel="Tipo">@context.Type.GetDescription()</MudTd>
                </RowTemplate>

                <PagerContent>
                    <MudTablePager PageSizeOptions="new int[]{5, 10, 25, 50, 100, int.MaxValue}"
                                    RowsPerPageString="Linhas por Pág."
                                   InfoFormat="{first_item}-{last_item} de {all_items}"
                                    AllItemsText="Tudo"
                                    />
                </PagerContent>
            </MudTable>
        }

        <br />
    </DialogContent>
    </MudDialog>

@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    [Parameter] public ImportDataModel ImportModel { get; set; } = new ImportDataModel();

    private void Cancel() => MudDialog.Cancel();
}